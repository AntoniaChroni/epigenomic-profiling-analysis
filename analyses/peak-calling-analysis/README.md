# Pipeline for peak calling analysis for CUT&RUN-Seq data Analysis

## Usage

To run the script in this module from the command line sequentially, use:

```
bsub < lsf-script.txt
bash 02-CnR-plotHeatmap.sh
```

`bsub < lsf-script.txt` and `bash 02-CnR-plotHeatmap.sh` are designed to be run as if they were called from this module directory even when called from outside of this directory.

Parameters according to the project and analysis strategy will need to be specified in the following scripts:
- `01-CnR-computeMatrix-cellLine1.sh`: define `variables`, `dataDir` and any other dir if necessary, and `samples`
- `01-CnR-computeMatrix-cellLine2.sh`: define `variables`, `dataDir` and any other dir if necessary, and `samples`
- `02-CnR-plotHeatmap.sh`: define `variables` if necessary
- `samples-all.txt`: define `samples`

**The data used for the current analysis included the blacklist in the pre-processing pipeline run.


## Folder content
This folder contains scripts tasked to do peak calling analysis for the project by using CUT&RUN-Seq data. The input files for this analysis were generated by using the [nf-core/cutandrun](https://nf-co.re/cutandrun/3.2.2/) pipeline.

[nf-core/cutandrun](https://nf-co.re/cutandrun/3.2.2/) is a best-practice bioinformatic analysis pipeline for CUT&RUN, CUT&Tag, and TIPseq experimental protocols that were developed to study protein-DNA interactions and epigenomic profiling.

This module aims to answer the following questions regarding:
- exploration of patterns of different members of a protein complex overall but also looking into patterns of specific members being co-recruited to promoters (or bivalent promoters), enhancers, super enhancers, intergenic regions etc.
 
### Methods

We used the [computeMatrix](https://deeptools.readthedocs.io/en/develop/content/tools/computeMatrix.html) function to calculate scores per genome regions and per peaks of interest (promoters, typical enhancers, super enhancers and other). Generated output files were used for visualization purposes with the [plotHeatmap](https://deeptools.readthedocs.io/en/develop/content/tools/plotHeatmap.html#plotheatmap) function. 


## Folder structure 

The structure of this folder is as follows:

```
├── 01-CnR-computeMatrix-cellLine1.sh
├── 01-CnR-computeMatrix-cellLine2.sh
├── 02-CnR-plotHeatmap.sh
├── input
|   └── samples-all.txt
├── lsf-script.txt
├── README.md
├── plots
|   └── 01-plotHeatmap
|       ├── cellLine1
|       └── cellLine2
└── results
|   ├── 01-enhancers
|   |  ├── cellLine1
|   |  └── cellLine2
|   ├── 02-macs-narrow
|   |   ├── cellLine1
|   |   └── cellLine2
|   ├── 03-computeMatrix
|   |   ├── cellLine1
|   |   └── cellLine2
|   └── 04-plotHeatmap
|       ├── cellLine1
|_______└── cellLine2
```
